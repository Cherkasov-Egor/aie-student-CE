# HW07 – Report

> Файл: `homeworks/HW07/report.md`  .

## 1. Datasets

Для проведения сравнительного анализа были выбраны следующие наборы данных:

1. **Dataset A:** `S07-hw-dataset-01.csv` (1200 наблюдений, 11 признаков).
   * **Особенности:** Наличие шумовых признаков и существенное различие в масштабах переменных, что критично для евклидовых метрик.
2. **Dataset B:** `S07-hw-dataset-02.csv` (1500 наблюдений, 6 признаков).
   * **Особенности:** Нелинейная топология кластеров и наличие выраженных аномалий (выбросов).
3. **Dataset C:** `S07-hw-dataset-03.csv` (2000 наблюдений, 9 признаков).
   * **Особенности:** Гетероскедастичность (различная плотность) групп и высокий уровень фонового шума.

## 2. Protocol

Применен строгий **Unsupervised-протокол** для обеспечения объективности сравнения:

* **Препроцессинг:** Использован `Pipeline`, включающий медианную импутацию (для отказоустойчивости) и обязательный `StandardScaler`. Масштабирование признаков признано ключевым этапом для корректной работы distance-based методов.
* **Поиск гиперпараметров:**
  * **KMeans:** Оптимизация количества кластеров $k \in [2, 15]$ через максимизацию Silhouette Score.
  * **DBSCAN:** Тонкая настройка `eps` через анализ k-distance графиков и максимизацию силуэта с учетом минимизации доли шума.
* **Метрики:** Комплексная оценка проводилась по трем критериям: **Silhouette** (плотность), **Davies-Bouldin** (разделимость) и **Calinski-Harabasz** (дисперсионное отношение).
* **Визуализация:** Снижение размерности до 2D выполнено с помощью PCA (random_state=42).

## 3. Models

На каждом датасете проведено сравнительное тестирование двух парадигм кластеризации:

1. **Центроидная (KMeans):** Поиск оптимального разбиения на гиперсферические области.
2. **Плотностная (DBSCAN):** Выделение связных областей произвольной формы и детекция шума.

## 4. Results

### 4.1 Dataset A

* **Лучший метод:** KMeans ($k=3$).
* **Метрики:** Silhouette: 0.522, DB Index: 1.149, CH Score: 2560.4.
* **Анализ:** Модель успешно выделила устойчивую структуру. DBSCAN на данном наборе показал склонность к избыточному дроблению данных на шум.

### 4.2 Dataset B

* **Лучший метод:** DBSCAN ($eps=0.5$, $min\_samples=5$).
* **Метрики:** Silhouette: 0.631 (на non-noise данных), доля шума: 7.5%.
* **Анализ:** Алгоритм подтвердил превосходство в работе с нелинейными формами, где KMeans не смог корректно разделить вложенные структуры.

### 4.3 Dataset C

* **Лучший метод:** KMeans ($k=5$).
* **Метрики:** Silhouette: 0.383, DB Index: 1.523, CH Score: 1204.5.
* **Анализ:** Несмотря на умеренные значения метрик, KMeans обеспечил наиболее интерпретируемое разбиение. DBSCAN оказался неэффективен из-за значительных перепадов плотности данных.

## 5. Analysis

### 5.1 Сравнение алгоритмов

* Выявлена фундаментальная ограниченность **KMeans** при работе с невыпуклыми (non-convex) кластерами.
* Подтверждена высокая чувствительность **DBSCAN** к вариативности локальной плотности.
* Установлено, что отсутствие масштабирования (scaling) приводит к деградации качества кластеризации на 30–40%.

### 5.2 Устойчивость (Stability)

* Тестирование на Dataset A (5 запусков KMeans с разными seed) показало **абсолютную устойчивость** (Std ARI = 0.000).
* **Вывод:** Решение инвариантно к начальной инициализации центроидов, что свидетельствует о высокой степени сепарабельности данных.

### 5.3 Интерпретация кластеров

* **PCA-проекция:** Визуально подтверждает адекватность выбранных моделей.
* **Анализ центроидов:** В Dataset A кластеры четко дифференцируются по уровням признаков (High/Medium/Low), что позволяет использовать результаты для сегментации объектов.

## 6. Conclusion

Эксперимент подтвердил, что универсального алгоритма не существует:

1. **KMeans** оптимален для данных с выраженной глобальной структурой и сферическими кластерами.
2. **DBSCAN** незаменим при наличии шума и сложной геометрии данных.
3. Важнейшим этапом является не выбор модели, а корректная подготовка данных и кросс-валидация через комбинацию внутренних метрик.
